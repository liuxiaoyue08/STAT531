AIC<-aic_table(data$Number,4,5)
View(AIC)
round(min(AIC),2)
spectrum(data$Number, main ="Unsmoothed periodogram")
spectrum(data$Number,method="ar", main ="Spectrum estimated via AR model picked by AIC")
spectrum(data$Number,spans=c(3,5,3), main="Smoothed periodogram",ylim=c(15,100))
spectrum(data$Number,spans=c(3,5,3), main="Smoothed periodogram")
acf(data$Number)
summary(acf(data$Number))
summary(acf(data$Number)$acf)
data_arma <-arima(data$Number,order = c(2,0,4))
data_arma
acf(data$Number)
help(arima.sim)
arima.sim(list(ar = c(1.9761,-0.9786),ma=c(-1.4487,0.3031,0.1004,0.0705)),n=3204)
acf(arima.sim(list(ar = c(1.9761,-0.9786),ma=c(-1.4487,0.3031,0.1004,0.0705)),n=3204))
acf(arima.sim(list(ar = c(1.9761,-0.9786),ma=c(-1.4487,0.3031,0.1004,0.0705)),n=3204),main='Simulation ARMA(2,4)')
x=seq(0,0.5,by=0.01)
y=1/(3.89-5.4*cos(2*pi*x)+1.6*cos(4*pi*x))
y2=3+4*cos(2*pi*x)+2*cos(4*pi*x)
plot(x,y,type='l',col='blue', xlab='w',ylab='spectral density',main='spectral density of AR(2)')
plot(x,y2,type='l',col='blue', xlab='w',ylab='spectral density',main='spectral density of MA(2)')
ARMAacf(ar=c(1.5,-0.8),ma=0)
acf(arima.sim(list(ar = c(1.5,-0.8),ma=0,n=3204))
)
acf(arima.sim(list(ar = c(1.5,-0.8),ma=0),n=3204)
）
acf(arima.sim(list(ar = c(1.5,-0.8),ma=0),n=500),main = ACF of AR(2))
acf(arima.sim(list(ar = c(1.5,-0.8),ma=0),n=500),main = 'ACF of AR(2)')
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of AR(2)')
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of MA(2)')
help(acf)
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of MA(2)',type='covariance')
acf(arima(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of MA(2)',type='covariance')
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of MA(2)',type='covariance')
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of AR(2)',type ='covariance')
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of AR(2)',type ='covariance')
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of AR(2)',type ='covariance')
set.seed(123456789)
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of AR(2)',type ='covariance')
acf(arima.sim(list(ar = 0,ma=c(1,1)),n=500),main = 'ACF of MA(2)',type='covariance')
data= read.table('C:/Users/Platina/Desktop',header=F)
data= read.table('C:/Users/Platina/Desktop/country year.txt',header=F)
View(data)
colnames(data)=c('country','year','rating')
library(ggplot2)
p11 = ggplot(aes(y = rating, x = year, fill = country), data = data)
p11
ggplot(df,aes(x=year,y=rating))+geom_point(aes(colour=country))
ggplot(data,aes(x=year,y=rating))+geom_point(aes(colour=country))
ggplot(data,aes(x=year,y=rating),lty='l')+geom_point(aes(colour=country))
ggplot(data,aes(x=year,y=rating),lty='l')+geom_point(aes(colour=country))+geom_line()
ggplot(data,aes(x=year,y=rating),lty='l')+geom_point(aes(colour=country))
ggplot(data,aes(x=year,y=rating))+geom_point(aes(colour=country))
help(qplot)
qplot(data=data,x=year,y=rating,color=country,geom=c('line','point'))
ablines()
help(abline)
ggplot(data,aes(x=year,y=rating),geom='line')+geom_point(aes(colour=country))
qplot(data=data,x=year,y=rating,color=country,geom=c('smooth','point'))
ggplot(data,aes(x=year,y=rating),geom='line')+geom_point(aes(colour=country))
ggplot(data,aes(x=year,y=rating))+geom_point(aes(colour=country))
ggplot(data,aes(x=year,y=rating))+geom_point(aes(colour=country),size=4)
```{r}
x <- read.table(file="https://ms.mcmaster.ca/~bolker/measdata/nycmeas.dat",header=FALSE)
x1 <- na.omit(x)
head(x1)
```
View(x)
x <- read.table(file="https://ms.mcmaster.ca/~bolker/measdata/nycmeas.dat",header=FALSE)
col.names(x)=c('Time', 'Case reprots')
head(x)
x <- read.table(file="https://ms.mcmaster.ca/~bolker/measdata/nycmeas.dat",header=FALSE)
colnames(x)=c('Time', 'Case reprots')
head(x)
x <- read.table(file="https://ms.mcmaster.ca/~bolker/measdata/nycmeas.dat",header=FALSE)
colnames(x)=c('Time', 'Cases')
head(x)
rm(x1)
plot(Cases~Time,data=x,type="l")
lines(x = x$Time, y = rep(mean(x1$Case, na.rm = T), length(x$Time)), col = "blue", lwd = 1.5)
lines(x = x$Time, y = rep(mean(x$Case, na.rm = T), length(x$Time)), col = "blue", lwd = 1.5)
spectrum(x,method='ar')
spectrum(x$Cases,method='ar')
install.packages("pomp")
setwd("D:/MA 2015/STAT531/project")
data<-read.table("Beijing_2015_HourlyPM25_created20160201.csv",header=T,skip=3)
View(data)
data<-read.csv("Beijing_2015_HourlyPM25_created20160201.csv",header=T,skip=3)
View(data)
data$time = data$Year+data$Month+data$Day
data$time = as.charactor(data$Year)+as.charactor(data$Month)+as.charactor(data$Day)
data$time = as.character(data$Year)+as.character(data$Month)+as.character(data$Day)
type(data$Date..LST)
class(data$Date..LST)
data<-read.csv("Beijing_2015_HourlyPM25_created20160201.csv",header=T,skip=3)
gp<-group_by(data,Year,Month,Day)
library(dplyr)
gp<-group_by(data,Year,Month,Day)
day_data<-summarize(data,pm2.5=mean(Value))
View(day_data)
day_data<-summarize(gp,pm2.5=mean(Value))
View(day_data)
data2014<-read.csv("Beijing_2014_HourlyPM25_created20150203.csv",header=T,skip=3)
gp2014<-group_by(data2014,Year,Month,Day)
day_data2014<-summarize(gp2014,pm2.5=mean(Value))
data2015<-read.csv("Beijing_2015_HourlyPM25_created20160201.csv",header=T,skip=3)
library(dplyr)
gp2015<-group_by(data2015,Year,Month,Day)
day_data2015<-summarize(gp2015,pm2.5=mean(Value))
data2013<-read.csv("Beijing_2013_HourlyPM25_created20140325.csv",header=T,skip=3)
data2013<-read.csv("Beijing_2013_HourlyPM2.5_created20140325.csv",header=T,skip=3)
gp2013<-group_by(data2013,Year,Month,Day)
day_data2013<-summarize(gp2013,pm2.5=mean(Value))
day_data2013_2015<-rbind(day_data2013,day_data2014,day_data2015)
View(day_data2013_2015)
write.csv(day_data2013_2015,file="day_data_2013_2015.csv",col.names=T)
write.table(day_data2013_2015,file="day_data_2013_2015.csv",col.names=T)
write.table(day_data2013_2015,file="day_data_2013_2015.csv",col.names=T,sep=",")
write.table(day_data2013_2015,file="day_data_2013_2015.csv",row.names=F,col.names=T,sep=",")
write.table(day_data2013_2015,file="day_data_2013_2015.csv",row.names=F,col.names=T,sep=",")
as.date(data$Date..LST.)
as.Date(data$Date..LST.)
day_data2013_2015$Time<-paste(day_data2013_2015$Year,day_data2013_2015$Month,day_data2013_2015$Day,sep='/')
day_data2013_2015$Time<-as.Date(day_data2013_2015$Time)
plot(day_data2013_2015$Time,day_data2013_2015$pm2.5)
plot(day_data2013_2015$Time,day_data2013_2015$pm2.5,lty='l')
plot(day_data2013_2015$Time,day_data2013_2015$pm2.5,type='l')
data2015<-read.csv("Beijing_2015_HourlyPM25_created20160201.csv",header=T,skip=3)
library(dplyr)
gp2015<-group_by(data2015,Year,Month,Day)
day_data2015<-summarize(gp2015,pm2.5=mean(Value))
data2014<-read.csv("Beijing_2014_HourlyPM25_created20150203.csv",header=T,skip=3)
gp2014<-group_by(data2014,Year,Month,Day)
day_data2014<-summarize(gp2014,pm2.5=mean(Value))
data2013<-read.csv("Beijing_2013_HourlyPM2.5_created20140325.csv",header=T,skip=3)
gp2013<-group_by(data2013,Year,Month,Day)
day_data2013<-summarize(gp2013,pm2.5=mean(Value))
data2012<-read.csv("Beijing_2012_HourlyPM2.5_created20140325.csv",header=T,skip=3)
gp2012<-group_by(data2012,Year,Month,Day)
day_data2012<-summarize(gp2012,pm2.5=mean(Value))
data2011<-read.csv("Beijing_2011_HourlyPM25_created20140709.csv",header=T,skip=3)
gp2011<-group_by(data2011,Year,Month,Day)
day_data2011<-summarize(gp2011,pm2.5=mean(Value))
data2010<-read.csv("Beijing_2010_HourlyPM25_created20140709.csv",header=T,skip=3)
gp2010<-group_by(data2010,Year,Month,Day)
day_data2010<-summarize(gp2010,pm2.5=mean(Value))
day_data2010_2015<-rbind(day_data2010,day_data_2011,day_data_2012,day_data2013,day_data2014,day_data2015)
write.table(day_data2010_2015,file="day_data_2010_2015.csv",row.names=F,col.names=T,sep=",")
day_data2010_2015<-rbind(day_data2010,day_data2011,day_data2012,day_data2013,day_data2014,day_data2015)
write.table(day_data2010_2015,file="day_data_2010_2015.csv",row.names=F,col.names=T,sep=",")
day_data2010_2015$Time<-paste(day_data2013_2015$Year,day_data2013_2015$Month,day_data2013_2015$Day,sep='/')
day_data2010_2015$Time<-paste(day_data2010_2015$Year,day_data2010_2015$Month,day_data2010_2015$Day,sep='/')
day_data2010_2015$Time<-as.Date(day_data2010_2015$Time)
write.table(day_data2010_2015,file="day_data_2010_2015.csv",row.names=F,col.names=T,sep=",")
plot(day_data2010_2015$Time,day_data2010_2015$pm2.5,type='l')
len(day_data2010[day_data2010$pm2.5<0])
`length(day_data2010[day_data2010$pm2.5<0])
''
length(day_data2010[day_data2010$pm2.5<0])
View(data2013)
View(day_data2010)
View(data2010)
library(dplyr)
data2015<-read.csv("Beijing_2015_HourlyPM25_created20160201.csv",header=T,skip=3)
data2015<-data2015[data2015$Value>0]
gp2015<-group_by(data2015,Year,Month,Day)
day_data2015<-summarize(gp2015,pm2.5=mean(Value))
data2014<-read.csv("Beijing_2014_HourlyPM25_created20150203.csv",header=T,skip=3)
data2014<-data2014[data2014$Value>0]
gp2014<-group_by(data2014,Year,Month,Day)
day_data2014<-summarize(gp2014,pm2.5=mean(Value))
data2013<-read.csv("Beijing_2013_HourlyPM2.5_created20140325.csv",header=T,skip=3)
data2013<-data2013[data2013$Value>0]
gp2013<-group_by(data2013,Year,Month,Day)
day_data2013<-summarize(gp2013,pm2.5=mean(Value))
data2012<-read.csv("Beijing_2012_HourlyPM2.5_created20140325.csv",header=T,skip=3)
data2012<-data2012[data2012$Value>0]
gp2012<-group_by(data2012,Year,Month,Day)
day_data2012<-summarize(gp2012,pm2.5=mean(Value))
data2011<-read.csv("Beijing_2011_HourlyPM25_created20140709.csv",header=T,skip=3)
data2011<-data2011[data2011$Value>0]
gp2011<-group_by(data2011,Year,Month,Day)
day_data2011<-summarize(gp2011,pm2.5=mean(Value))
data2010<-read.csv("Beijing_2010_HourlyPM25_created20140709.csv",header=T,skip=3)
data2010<-data2010[data2010$Value>0]
gp2010<-group_by(data2010,Year,Month,Day)
day_data2010<-summarize(gp2010,pm2.5=mean(Value))
day_data2010_2015<-rbind(day_data2010,day_data2011,day_data2012,day_data2013,day_data2014,day_data2015)
write.table(day_data2010_2015,file="day_data_2010_2015.csv",row.names=F,col.names=T,sep=",")
day_data2010_2015$Time<-paste(day_data2010_2015$Year,day_data2010_2015$Month,day_data2010_2015$Day,sep='/')
day_data2010_2015$Time<-as.Date(day_data2010_2015$Time)
write.table(day_data2010_2015,file="day_data_2010_2015.csv",row.names=F,col.names=T,sep=",")
library(dplyr)
data2015<-read.csv("Beijing_2015_HourlyPM25_created20160201.csv",header=T,skip=3)
data2015<-data2015[data2015$Value>0,]
gp2015<-group_by(data2015,Year,Month,Day)
day_data2015<-summarize(gp2015,pm2.5=mean(Value))
data2014<-read.csv("Beijing_2014_HourlyPM25_created20150203.csv",header=T,skip=3)
data2014<-data2014[data2014$Value>0,]
gp2014<-group_by(data2014,Year,Month,Day)
day_data2014<-summarize(gp2014,pm2.5=mean(Value))
data2013<-read.csv("Beijing_2013_HourlyPM2.5_created20140325.csv",header=T,skip=3)
data2013<-data2013[data2013$Value>0,]
gp2013<-group_by(data2013,Year,Month,Day)
day_data2013<-summarize(gp2013,pm2.5=mean(Value))
data2012<-read.csv("Beijing_2012_HourlyPM2.5_created20140325.csv",header=T,skip=3)
data2012<-data2012[data2012$Value>0,]
gp2012<-group_by(data2012,Year,Month,Day)
day_data2012<-summarize(gp2012,pm2.5=mean(Value))
data2011<-read.csv("Beijing_2011_HourlyPM25_created20140709.csv",header=T,skip=3)
data2011<-data2011[data2011$Value>0,]
gp2011<-group_by(data2011,Year,Month,Day)
day_data2011<-summarize(gp2011,pm2.5=mean(Value))
data2010<-read.csv("Beijing_2010_HourlyPM25_created20140709.csv",header=T,skip=3)
data2010<-data2010[data2010$Value>0,]
gp2010<-group_by(data2010,Year,Month,Day)
day_data2010<-summarize(gp2010,pm2.5=mean(Value))
day_data2010_2015<-rbind(day_data2010,day_data2011,day_data2012,day_data2013,day_data2014,day_data2015)
write.table(day_data2010_2015,file="day_data_2010_2015.csv",row.names=F,col.names=T,sep=",")
day_data2010_2015$Time<-paste(day_data2010_2015$Year,day_data2010_2015$Month,day_data2010_2015$Day,sep='/')
day_data2010_2015$Time<-as.Date(day_data2010_2015$Time)
write.table(day_data2010_2015,file="day_data_2010_2015.csv",row.names=F,col.names=T,sep=",")
plot(day_data2010_2015$Time,day_data2010_2015$pm2.5,type='l')
spectrum(day_data2010_2015$pm2.5,method='ar')
data<-cbind(day_data2010_2015$Time,day_data2010_2015$pm2.5)
write.table(data,file="day_data.csv",row.names=F,col.names=T,sep=",")
View(data)
data<-read.csv("day_data_2010_2015.csv",header=T)
View(data)
temp<-read.csv("temp.csv",header=T)
View(temp)
temp=temp[,c(6,7,12)]
View(temp)
temp$TMAX[temp$TMAX==-9999]<-NULL
temp$TMIN[temp$TMIN==-9999]<-NULL
View(temp)
temp$TMAX[temp$TMAX==-9999,]<-NULL
temp$TMIN[temp$TMIN==-9999,]<-NULL
temp$TMAX[temp$TMAX==-9999]<-NA
temp$TMIN[temp$TMIN==-9999]<-NA
View(temp)
temp<-temp[:1643,]
temp<-temp[1:1643,]
temp$DATE<-as.Date(temp$DATE)
help("as.Date")
temp$Year<-as.character(temp$DATE)[1:4]
temp$Year<-as.character(temp$DATE)[1:4,]
as.Date(20100101,format="YYYYMMDD")
temp$Time<-as.Date(as.character(temp$DATE))
temp$Time<-as.Date(as.character(temp$DATE),format = "%Y%m%d")
View(temp)
temp_pm<-left_join(data,temp)
data$Time<-as.Date(data$Time)
View(data)
temp_pm<-left_join(data,temp)
View(temp_pm)
temp_pm2<-temp_pm[,c(5,4,7,8)]
temp_pm2$TD<-temp_pm2$TMAX-temp_pm2$TMIN
write.table(temp_pm2,file="temp_pm25.csv",row.names=F,col.names=T,sep=",")
write.table(temp,file="temp.csv",row.names=F,col.names=T,sep=",")
plot(ts(cbind(temp_pm2$pm2.5,temp_pm2$TD)))
View(temp_pm2)
temp_an<-temp_pm2[1:1060,]
plot(ts(cbind(temp_an$pm2.5,temp_an$TD)))
write.table(temp_an,file="temp_pm25_2010_2012.csv",row.names=F,col.names=T,sep=",")
plot(ts(cbind(temp_an$pm2.5,temp_an$TMAX)))
plot(ts(cbind(temp_an$pm2.5,temp_an$TMIN)))
x <- read.table(file="temp_pm25_2010_2012.csv",header=True)
x <- read.table(file="temp_pm25_2010_2012.csv",header=T)
x <- read.csv(file="temp_pm25_2010_2012.csv",header=T)
head(x)
time <- x$Time
pm25 <- x$pm2.5
td <- x$TD
plot(ts(cbind(pm25,td),start=2010),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
plot(ts(cbind(pm25,td),start=as.Date("2010-01-01")),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
plot(ts(cbind(pm25,td),start="2010-01-01"),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
plot(ts(cbind(pm25,td),frequency = 365,start=as.Date("2010-01-01"),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
plot(ts(cbind(pm25,td),frequency = 365,start=as.Date("2010-01-01")),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
plot(ts(cbind(pm25,td)),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
spectrum((pm25))
spectrum(pm25,method="ar")
spectrum(td,method="ar")
spectrum(td)
require(mFilter)
pm25_hp <- hpfilter(pm25, freq=100,type="lambda",drift=F)$cycle
td_hp <- hpfilter(td, freq=100,type="lambda",drift=F)$cycle
plot(time,pm_hp,type="l",xlab="Day",ylab="")
par(new=TRUE)
plot(t,td_hp,col="red",type="l",axes=FALSE,xlab="",ylab="")
axis(side=4, col="red")
pm25_hp <- hpfilter(pm25, freq=100,type="lambda",drift=F)$cycle
require(mFilter)
install.packages("mFilter")
require(mFilter)
pm25_hp <- hpfilter(pm25, freq=100,type="lambda",drift=F)$cycle
td_hp <- hpfilter(td, freq=100,type="lambda",drift=F)$cycle
plot(time,pm_hp,type="l",xlab="Day",ylab="")
par(new=TRUE)
plot(t,td_hp,col="red",type="l",axes=FALSE,xlab="",ylab="")
axis(side=4, col="red")
plot(time,pm_hp,type="l",xlab="Day",ylab="")
plot(time,pm25_hp,type="l",xlab="Day",ylab="")
plot(time,pm25_hp,type="l",xlab="Day",ylab="")
plot(time,td_hp,col="red",type="l",axes=FALSE,xlab="",ylab="")
plot(as.Date(time), pm25_hp,type="l",xlab="Day",ylab="")
plot(as.Date(time),td_hp,col="red",type="l",axes=FALSE,xlab="",ylab="")
plot(as.Date(time), pm25_hp,type="l",xlab="Day",ylab="")
par(new=TRUE)
plot(as.Date(time),td_hp,col="red",type="l",axes=FALSE,xlab="",ylab="")
axis(side=4, col="red")
View(x)
plot(ts(cbind(pm25,td)),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
plot(ts(cbind(pm25,td)),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
x <- read.csv(file="temp_pm25_2010_2012.csv",header=T)
head(x)
t <- x$Time
p <- x$pm2.5
d <- x$TD
plot(ts(cbind(p,d)),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
arima(d,xreg=p,order=c(1,0,0))
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- arima(data,order=c(p,0,q))$aic
}
}
dimnames(table) <- list(paste("<b> AR",0:P, "</b>", sep=""),paste("MA",0:Q,sep=""))
table
}
low_aic_table <- aic_table(d,4,5,xreg=p)
require(knitr)
kable(low_aic_table,digits=2)
aic_table <- function(data,P,Q,xreg=NULL){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- arima(data,order=c(p,0,q))$aic
}
}
dimnames(table) <- list(paste("<b> AR",0:P, "</b>", sep=""),paste("MA",0:Q,sep=""))
table
}
low_aic_table <- aic_table(d,4,5,xreg=p)
require(knitr)
kable(low_aic_table,digits=2)
arima(d,xreg=p,order=c(4,0,3))
arima(log(d),xreg=log(p),order=c(4,0,3))
ld <- log(d)
lp <- log(p)
arima(ld,xreg=lp,order=c(4,0,3))
low_aic_table <- aic_table(ld,4,5,xreg=lp)
require(knitr)
kable(low_aic_table,digits=2)
arima(ld,xreg=lp,order=c(2,0,1))
plot(ts(cbind(lp,ld)),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
log_lik_ratio <- as.numeric(
logLik(arima(ld,xreg=lp,order=c(2,0,1))) -
logLik(arima(ld,order=c(2,0,1)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
log_lik_ratio <- as.numeric(
logLik(arima(d,xreg=p,order=c(4,0,3))) -
logLik(arima(d,order=c(4,0,3)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
log_lik_ratio <- as.numeric(
logLik(arima(ld,xreg=lp,order=c(4,0,3))) -
logLik(arima(ld,order=c(4,0,3)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
log_lik_ratio <- as.numeric(
logLik(arima(d,xreg=p,order=c(4,0,2))) -
logLik(arima(d,order=c(4,0,2)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
log_lik_ratio <- as.numeric(
logLik(arima(ld,xreg=lp,order=c(4,0,2))) -
logLik(arima(ld,order=c(4,0,2)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
log_lik_ratio <- as.numeric(
logLik(arima(ld,xreg=lp,order=c(3,0,3))) -
logLik(arima(ld,order=c(3,0,3)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
help(arima)
arima(ld,xreg=lp,order=c(2,0,1),seasonal=list(order=c(1,0,0),period=365))
arima(ld,xreg=lp,order=c(2,0,1),seasonal=list(order=c(1,0,0),period=30))
arima(ld,xreg=lp,order=c(2,0,1))
pdarma <- arima(ld,xreg=lp,order=c(2,0,1))
acf(resid(pdarma))
parma <- arima(d,xreg=lp,order=c(2,0,1))
darma <- arima(d,order=c(2,0,1))
acf(resid(darma))
spectrum(p,method='ar')
spectrum(d,method='ar')
spectrum(lp,method='ar')
spectrum(ld,method='ar')
low_aic_table <- aic_table(d,4,5,xreg=p)
require(knitr)
kable(low_aic_table,digits=2)
low_aic_table <- aic_table(d,5,6,xreg=p)
require(knitr)
kable(low_aic_table,digits=2)
low_aic_table <- aic_table(d,5,6)
require(knitr)
kable(low_aic_table,digits=2)
acf(d)
acf(p)
acf(lp)
acf(ld)
log_lik_ratio <- as.numeric(
logLik(arima(ld,xreg=lp,order=c(2,0,1))) -
logLik(arima(ld,order=c(2,0,1)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
log_lik_ratio <- as.numeric(
logLik(arima(d,xreg=p,order=c(2,0,1))) -
logLik(arima(d,order=c(2,0,1)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
arima(d,order=c(2,0,1), xreg=p)
low_aic_table <- aic_table(d,5,6,xreg=p)
require(knitr)
kable(low_aic_table,digits=2)
LRT_pval
p2012 <- p[706:1060]
d2012 <- d[706:1060]
arima(d2012,c(2,0,1),xreg=p2012)
low_aic_table <- aic_table(p,5,6)
require(knitr)
kable(low_aic_table,digits=2)
plot(ts(cbind(p2012,d2012)),main = "PM2.5(pm25) and temperature difference(td) for Beijing",xlab="Day")
plot(t[706:1060],p2012,type="l",xlab="Year",ylab="")
par(new=TRUE)
plot(t[706:1060],d2012,col="red",type="l",axes=FALSE,xlab="",ylab="")
axis(side=4, col="red")
length(t)
t[706:1060]
t2012
t2012 <- as.Date(t[706:1060])
arima(d2012,c(2,0,1),xreg=p2012)
plot(t2012,p2012,type="l",xlab="Year",ylab="")
par(new=TRUE)
plot(t2012,d2012,col="red",type="l",axes=FALSE,xlab="",ylab="")
axis(side=4, col="red")
arima(d,xreg=p,order=c(4,0,3))
r <- resid(arima(d,xreg=d,order=c(2,0,1)))
arima(d,order=c(2,0,1), xreg=p)
r <- resid(arima(d,xreg=p,order=c(2,0,1)))
plot(r)
acf(r)
spectrum(r)
spectrum(r，method="ar")
acf(r)
r <- resid(arima(d,xreg=p,order=c(2,0,1)))
plot(r)
acf(r)
delta_p <- p - x$pm2.5[x$Time %in% (t-1)]
delta_p <- p - x$pm2.5[as.Date(x$Time) %in% (t-1)]
delta_p <- p - x$pm2.5[as.Date(x$Time) %in% (as.Date(t-1))]
as.numeric(x$Time)
acf(r)
delta_p <- p - x$pm2.5[as.numeric(x$Time) %in% (as.numeric(t)-1)]
len(delta_p)
length(delta_p)
plot(t,d,type="l",xlab="Day",ylab="")
par(new=TRUE)
plot(t,delta_p,col="red",type="l",axes=FALSE,xlab="",ylab="")
axis(side=4,col="red")
delta_p <- p - x$pm2.5[as.numeric(x$Time) %in% (as.numeric(t)-1)]
plot(as.Date(t),d,type="l",xlab="Day",ylab="")
par(new=TRUE)
plot(as.Date(t),delta_p,col="red",type="l",axes=FALSE,xlab="",ylab="")
axis(side=4,col="red")
t2 <- as.Date(t)
plot(t2,d,type="l",xlab="Day",ylab="")
par(new=TRUE)
plot(t2,delta_p,col="red",type="l",axes=FALSE,xlab="",ylab="")
delta_p <- p - x$pm2.5[as.numeric(x$Time) %in% (as.numeric(t)-1)]
length(x$pm2.5[as.numeric(x$Time) %in% (as.numeric(t)-1)])
delta_p <- p[2:1060] - x$pm2.5[as.numeric(x$Time) %in% (as.numeric(t)-1)]
t2 <- as.Date(t)
plot(t2,d,type="l",xlab="Day",ylab="")
par(new=TRUE)
plot(t2,delta_p,col="red",type="l",axes=FALSE,xlab="",ylab="")
t2 <- as.Date(t[2:1060])
d2 <- d[2:1060]
plot(t2,d2,type="l",xlab="Day",ylab="")
par(new=TRUE)
plot(t2,delta_p,col="red",type="l",axes=FALSE,xlab="",ylab="")
axis(side=4,col="red")
low_aic_table <- aic_table(d,5,6,xreg=delta_p)
require(knitr)
kable(low_aic_table,digits=2)
log_lik_ratio <- as.numeric(
logLik(arima(d,xreg=dealta_p,order=c(2,0,1))) -
logLik(arima(d,order=c(2,0,1)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
```
log_lik_ratio <- as.numeric(
logLik(arima(d2,xreg=delta_p,order=c(2,0,1))) -
logLik(arima(d2,order=c(2,0,1)))
)
LRT_pval <- 1-pchisq(2*log_lik_ratio,df=1)
arima(d,xreg=delta_p,c(2,0,1))
arima(d2,xreg=delta_p,c(2,0,1))
LRT_pval
